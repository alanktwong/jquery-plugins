<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>jQuery Publish/Subscribe: No Data Demo Page</title>

	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.js"></script>
	<!--
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.js"></script>
	-->
	
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.3/underscore-min.js"></script>
	<script type="text/javascript" src="../jquery.pubsub.js"></script>
	<script type="text/javascript" src="../../log4jq/jquery.log4jq.js"></script>
<script>
$(document).ready(function() {
	var logger = $.configureLog4jq({
		enabled: true,
		level : "debug",
		targets : [
			{
				name: "console",
				enabled: true
			}
		]
	});
	
	var callbacks = {
		topic : "/example",
		notify : function(notification) {
			var msg = (notification.isSynchronous() ? "sync" : "async");
			msg = msg + " notification of parent subscriber: " + notification.publishTopic + " -> " + notification.currentTopic;
			$.debug(msg);
			if (notification.isSynchronous()) {
				$( "#parent", "#sync" ).append( "<p>" + msg + "</p>" );
			} else {
				$( "#parent", "#async" ).append( "<p>" + msg + "</p>" );
			}
		},
		nodata : {
			topic : "/example/nodata",
			one : {
				notify : function(notification) {
					var msg = (notification.isSynchronous() ? "sync" : "async");
					msg = msg + " notification of 1st subscriber: " + notification.publishTopic + " -> " + notification.currentTopic;
					$.debug(msg);
					if (notification.isSynchronous()) {
						$( "#receiver1", "#sync" ).append( "<p>" + msg + "</p>" );
					} else {
						$( "#receiver1", "#async" ).append( "<p>" + msg + "</p>" );
					}
				}
			},
			two : {
				notify : function(notification) {
					var msg = (notification.isSynchronous() ? "sync" : "async");
					msg = msg + " notification of 2nd subscriber: " + notification.publishTopic + " -> " + notification.currentTopic;
					$.debug(msg);
					if (notification.isSynchronous()) {
						$( "#receiver2", "#sync").append( "<p>" + msg + "</p>" );
					} else {
						$( "#receiver2", "#async").append( "<p>" + msg + "</p>" );
					}
				}
			}
		},
		options : {
			progress: function(notification) {
				var msg = (notification.isSynchronous() ? "sync" : "async") + " progress: " + notification.publishTopic + " -> " + notification.currentTopic;
				$.info(msg);
			},
			done: function(notification) {
				var msg = (notification.isSynchronous() ? "sync" : "async") + " done: " + notification.publishTopic + " -> " + notification.currentTopic;
				$.info(msg);
			},
			fail: function(notification) {
				var msg = (notification.isSynchronous() ? "sync" : "async") + " fail: " + notification.publishTopic + " -> " + notification.currentTopic;
				$.info(msg);
			},
			always: function(notification) {
				var msg = (notification.isSynchronous() ? "sync" : "async") + " fail: " + notification.publishTopic + " -> " + notification.currentTopic;
				$.info(msg);
			}
		}
	};
	
	
	$.subscribe( callbacks.topic, callbacks.notify);
	$.subscribe( callbacks.nodata.topic, callbacks.nodata.one.notify);
	$.subscribe( callbacks.nodata.topic, callbacks.nodata.two.notify);

	// the subscriptions are triggered through a publish call on the topic
	$.publishSync(callbacks.nodata.topic, callbacks.options);
	$.publish(callbacks.nodata.topic, callbacks.options);
});
</script>
</head>
<body>
	<h3>jQuery PubSub: NoData Usage</h3>
	<div id="note">
		<p>Only synchronous part of demo works for co-publishing</p>
		<p>Asynchronous part of demo does work for co-publishing</p>
	</div>
	<div id="notify" style="font-size: 14px;">
		<div id="sync">
			<p id="parent"></p>
			<p id="receiver2"></p>
			<p id="receiver1"></p>
		</div>
		<div id="async">
			<p id="parent"></p>
			<p id="receiver2"></p>
			<p id="receiver1"></p>
		</div>
	</div>
</body>

</html>